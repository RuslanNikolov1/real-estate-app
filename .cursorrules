# Cursor Rules for Real Estate App

## Project Context
This is a Next.js real estate application built with TypeScript, React, and SCSS modules.

## Code Style & Preferences
- Use TypeScript with strict typing
- Use SCSS modules for styling (`.module.scss` files)
- Follow React best practices with functional components and hooks
- Use `'use client'` directive for client components in Next.js 13+
- Prefer named exports over default exports

## Architecture Guidelines
- Components are organized in feature-based folders under `src/features/`
- Shared UI components go in `src/components/ui/`
- Filter components have their own state and pass updates via callbacks
- Each property type has its own filter page in `filter-subpages/`
- Map component is shared and receives location state from parent

## Common Patterns
- Filter components manage their own internal state
- Use `useRef` for mutable values that shouldn't trigger re-renders
- Use `useCallback` for memoized callbacks passed to child components
- Use `useMemo` for expensive computations
- Action buttons are passed to parent via render props pattern

## Naming Conventions
- Component files: PascalCase (e.g., `MapFiltersPage.tsx`)
- Style files: PascalCase with `.module.scss` (e.g., `MapFiltersPage.module.scss`)
- Utility files: camelCase (e.g., `constants.tsx`)
- Bulgarian labels are used in the UI (e.g., "Търси", "Изчисти")

## Important Notes
- The map should always be present when a property type is selected
- Filters should handle their own state and notify parent via callbacks
- Floating action buttons are centered horizontally at the bottom
- Use Phosphor Icons for UI icons
- Filter containers should have white backgrounds with rounded corners

## When Making Changes
- Always check for existing similar patterns before creating new ones
- Ensure responsive design for mobile devices
- Test that filter state persists correctly when clearing
- Maintain consistency with existing filter component patterns

────────────────────────────────────────
MAP STICKINESS RULES FOR THIS PROJECT
────────────────────────────────────────

In this project, the Google Map must ALWAYS stay visible while the user scrolls the filters. When updating layout, SCSS, or components related to MapFiltersPage, Cursor must follow these rules:

────────────────────────────────────────
GENERAL RULES
────────────────────────────────────────

1. The map is located inside:
   - MapFiltersPage.tsx
   - .rightFiltersColumn
   - .mapWrapper
   - .mapContainer

2. The layout is a two-column grid using .filtersMapLayout:
   - Left: filters
   - Right: map + map-related filters

3. The map must stick while the user scrolls the page.

────────────────────────────────────────
STICKY MAP RULES
────────────────────────────────────────

1. The map container or the right column MUST use:
   - position: sticky;
   - top: <header_height>;

2. The map must stay visible as the user scrolls the left column filters.

3. The map's height must be tied to the viewport. Use:
   - height: calc(100vh - <offset>);
   - overflow: hidden;

4. The parent columns and containers must NOT break sticky behavior:
   - No `overflow: hidden`
   - No `overflow: auto`
   - No `overflow: scroll`
   - No position: relative on parents unless necessary

5. Cursor must ensure:
   - .rightFiltersColumn enables sticky positioning
   OR
   - .mapContainer itself becomes sticky
   - Only ONE sticky layer should be applied unless requested.

────────────────────────────────────────
APPLY STICKY TO EXISTING CLASSES
────────────────────────────────────────

Cursor must apply sticky logic to THESE EXACT CLASSES in SCSS files:

Right column option:
------------------------------------
.rightFiltersColumn {
    position: sticky;
    top: 80px;        // adjust if header changes
    height: calc(100vh - 80px);
    overflow-y: auto;
}

Map-only option:
------------------------------------
.mapContainer {
    position: sticky;
    top: 80px;
    height: calc(100vh - 80px);
}

Cursor must never create new wrapper divs to achieve stickiness unless necessary. It should modify the existing layout.

────────────────────────────────────────
RESPONSIVENESS
────────────────────────────────────────

On screens below the LG breakpoint:
- Sticky behavior must be disabled.
- Map should stack under filters normally.
- Cursor must wrap sticky rules inside:

@media (min-width: $breakpoint-lg) {
   /* sticky behavior here */
}

────────────────────────────────────────
DO NOT BREAK THESE
────────────────────────────────────────

1. Do NOT change grid structure in .filtersMapLayout:
   grid-template-columns: minmax(0, 1fr) minmax(0, 1.15fr)

2. Do NOT modify .mapContainer border, overflow: hidden, or Google Map initialization code.

3. Do NOT introduce new parent overflow properties that break sticky behavior.

4. If sticky is not working, Cursor must check parents of the sticky element and remove:
   overflow: hidden | auto | scroll
   from them.

────────────────────────────────────────
SPECIAL FIXES CURSOR MUST APPLY IF NEEDED
────────────────────────────────────────

1. If sticky fails, ensure:
   html, body { overflow-y: visible; }

2. Ensure MapWrapper DOES NOT have:
   overflow: auto OR hidden

3. Ensure .mapFiltersPage and .main DO NOT have fixed height or min-height: 100vh unless necessary.

